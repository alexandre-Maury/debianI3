# roles/startup/task/install_apt.yml

---

- name: roles/startup - Installer les dépendances APT de base
  ansible.builtin.package:
    name: "{{ item }}"
    state: present
    install_recommends: no
  loop: '{{ base_cli_deps }}'
  become: true

- name: Créer un dossier pour bat
  ansible.builtin.file:
    path: "/home/{{ ansible_user_id }}/.local/bin"  # Chemin dynamique vers le dossier de l'utilisateur
    state: directory
    mode: '0755'  # Permissions pour exécution

- name: Ajouter un lien symbolique pour bat
  ansible.builtin.file:
    src: /usr/bin/batcat
    dest: "/home/{{ ansible_user_id }}/.local/bin/bat"  # Lien symbolique vers bat
    state: link

- name: Détecter les capteurs - lm-sensors
  ansible.builtin.shell: |
    yes | sensors-detect
  changed_when: true

- name: Activer le service avahi-daemon
  ansible.builtin.systemd:
    name: avahi-daemon
    enabled: true
  become: true  # Utilisation des privilèges sudo

- name: Activer le service acpid
  ansible.builtin.systemd:
    name: acpid
    enabled: true
  become: true  # Utilisation des privilèges sudo

- name: Activer le service bluetooth
  ansible.builtin.systemd:
    name: bluetooth
    enabled: true
  become: true  # Utilisation des privilèges sudo

- name: Activer le service lightdm
  ansible.builtin.systemd:
    name: lightdm
    enabled: true
  become: true  # Utilisation des privilèges sudo